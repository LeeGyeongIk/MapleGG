<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"
        integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
    <title>Document</title>
</head>

<body>
    <style>
        :root {
            --animation-delay: 2s forwards;
        }

        #content {
            width: 500px;
            height: fit-content;
            position: relative;
            margin: 0 auto;
            margin-top: 5%;
            text-align: center;
        }

        .damage1 {
            width: 100%;
            position: absolute;
            animation: damage1 var(--animation-delay);
        }

        .damage2 {
            width: 100%;
            position: absolute;
            animation: damage2 var(--animation-delay);
        }

        .damage3 {
            width: 100%;
            position: absolute;
            animation: damage3 var(--animation-delay);
        }

        .damage4 {
            width: 100%;
            position: absolute;
            animation: damage4 var(--animation-delay);
        }

        .damage5 {
            width: 100%;
            position: absolute;
            animation: damage5 var(--animation-delay);
        }

        .damage6 {
            width: 100%;
            position: absolute;
            animation: damage6 var(--animation-delay);
        }

        .damage7 {
            width: 100%;
            position: absolute;
            animation: damage7 var(--animation-delay);
        }

        .damage8 {
            width: 100%;
            position: absolute;
            animation: damage8 var(--animation-delay);
        }

        .damage9 {
            width: 100%;
            position: absolute;
            animation: damage9 var(--animation-delay);
        }

        .damage10 {
            width: 100%;
            position: absolute;
            animation: damage10 var(--animation-delay);
        }

        @keyframes damage1 {
            from {
                opacity: 1;
                left: 0;
                bottom: 20%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 24%;
            }
        }

        @keyframes damage2 {
            from {
                opacity: 1;
                left: 0;
                bottom: 24%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 28%;
            }
        }

        @keyframes damage3 {
            from {
                opacity: 1;
                left: 0;
                bottom: 28%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 32%;
            }
        }

        @keyframes damage4 {
            from {
                opacity: 1;
                left: 0;
                bottom: 32%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 36%;
            }
        }

        @keyframes damage5 {
            from {
                opacity: 1;
                left: 0;
                bottom: 36%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 40%;
            }
        }

        @keyframes damage6 {
            from {
                opacity: 1;
                left: 0;
                bottom: 40%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 44%;
            }
        }

        @keyframes damage7 {
            from {
                opacity: 1;
                left: 0;
                bottom: 44%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 48%;
            }
        }

        @keyframes damage8 {
            from {
                opacity: 1;
                left: 0;
                bottom: 48%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 52%;
            }
        }

        @keyframes damage9 {
            from {
                opacity: 1;
                left: 0;
                bottom: 52%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 56%;
            }
        }

        @keyframes damage10 {
            from {
                opacity: 1;
                left: 0;
                bottom: 56%;
            }

            to {
                opacity: 0;
                left: 0;
                bottom: 60%;
            }
        }
    </style>

    <div id="content">
        <h1>핑크빈 쳐보던가</h1>
        <img onclick="click_damage_btn(btn_count)" src="../static/img/damage_measurement/핑크빈.png" style="margin-top:100%;
        cursor:pointer;
        outline:none;
        -webkit-tap-highlight-color : rgba(0,0,0,0);">
    </div>

    <script>
        let btn_count = 0;
        let damage_combo = 10;

        function click_damage_btn() {
            const templete_head = `<div class="damage damage_${btn_count}">`;
            const templete_tail = `</div>`;
            const damage_arr = new Array();
            let btn_count_clone = btn_count;
            for (var i = 0; i < damage_combo; i++) {
                damage_arr.push(create_damage_object(i));
            }

            for (var i = 0; i < damage_combo; i++) {
                if (i != 0) {
                    (function (x) {
                        setTimeout(function () {	// 인스턴스 함수로 설정
                            damage_object = templete_head + damage_arr[x] + templete_tail;
                            $("#content").append(damage_object);
                            $(".damage_img").attr("style", "margin-left: -10px");
                        }, 100 * x);
                    })(i);	// 시간 설정
                } else {
                    damage_object = templete_head + damage_arr[i] + templete_tail;
                    $("#content").append(damage_object);
                    $(".damage_img").attr("style", "margin-left: -10px");
                }
            }

            remove_damage_object(btn_count_clone)
            btn_count++;
        }

        function create_damage_object(damage_iterator) {
            const max_damage = 10000000000;
            const min_damage = 0;
            const damage = Math.floor(Math.random() * (max_damage - min_damage + 1) + min_damage);
            const damage_str = damage.toString();
            let templete_body = ``;
            let damage_object;
            damage_iterator++;

            templete_body += `<div class="damage${damage_iterator}">`;
            for (var j = 0; j < damage_str.length; j++) {
                templete_body += `<img src="../static/img/damage_skin/기본데미지스킨/크리티컬x/기본데미지_크리티컬x_${damage_str[j]}.png" class="damage_img">`
            }
            templete_body += "</div>";

            damage_object = templete_body;

            return damage_object;
        }

        function remove_damage_object(btn_count_clone) {   // 2초 뒤 엘리먼트 삭제
            setTimeout(function () {	// 인스턴스 함수로 설정
                $(".damage_" + btn_count_clone.toString()).remove();
            }, 5000)	// 시간 설정
        }
    </script>
</body>

</html>